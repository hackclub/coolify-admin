<div class="page-header">
  <h1>Coolify Admin - Teams & Servers</h1>
  <%= link_to "Add New Team", new_coolify_team_path, class: "btn btn-primary" %>
</div>

<% if @teams_data.empty? %>
  <div class="empty-state">
    <p>No teams configured yet.</p>
    <p><%= link_to "Add your first team", new_coolify_team_path %> to get started.</p>
  </div>
<% else %>
  <div class="teams-list">
    <% @teams_data.each do |data| %>
      <div class="team-card">
        <div class="team-header">
          <div class="team-header-left">
            <h2><%= data[:team].name %></h2>
            <div class="team-meta">
              <span class="team-url"><%= data[:team].base_url %></span>
              <span class="team-token">Token: <%= data[:team].masked_token %></span>
            </div>
          </div>
          <div class="team-actions">
            <%= button_to "Delete", coolify_team_path(data[:team]), 
                method: :delete, 
                class: "btn btn-danger",
                form: { data: { turbo_confirm: "Are you sure you want to delete '#{data[:team].name}'? This cannot be undone." } } %>
          </div>
        </div>

        <% if data[:error] %>
          <div class="error-message">
            ⚠️ <%= data[:error] %>
          </div>
        <% else %>
          <div class="tree-section">
            <% servers = data[:tree]["servers"] || [] %>
            <h3>Servers (<%= servers.length %>)</h3>
            <% if servers.empty? %>
              <p class="no-data">No servers found</p>
            <% else %>
                  <ul class="tree-list server-list">
                    <% servers.each do |server| %>
                      <li class="tree-item server-item">
                        <div class="item-name server-name"><%= server["name"] %></div>
                        <div class="server-url"><%= server["ip"] %></div>
                        <div class="server-key">
                          <% if server["private_key_name"] %>
                            🔑 <%= server["private_key_name"] %>
                          <% elsif server["private_key_id"] %>
                            Key ID: <%= server["private_key_id"] %>
                          <% else %>
                            No key configured
                          <% end %>
                        </div>
                      </li>
                    <% end %>
                  </ul>
            <% end %>
          </div>
        <% end %>
      </div>
    <% end %>
  </div>
<% end %>

